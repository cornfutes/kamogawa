<!DOCTYPE html>
<html lang=en-US>
<title>{{.BrandName}}</title>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="The best way to access your cloud infrastructure.">
<link rel="stylesheet" href="./style.css">
<!-- Prevent fake favicon requests. https://stackoverflow.com/questions/1321878/how-to-prevent-favicon-ico-requests. -->
<link rel="icon" href="data:;base64,iVBORw0KGgo=">

<body class="üí™ ü™ú üçú üìú üö´">
  <header id="header" class="üí™ üéØ">
    <div class="üí™" id="header-child">
      <div class="üí™">
        <h1 id="logo" class="üçú">
          <a href="/"><span id="logo-image">Â∑ù</span></a>
          <span id="tag-beta"><a href="{{.EapUrl}}">Early Access</a></span>
        </h1>
      </div>
      <div id="search-box" class="üí™ üå≥ üëª">
        <input class="üå≥"
          type="text"
          placeholder="Search"
          spellcheck="false"
          autocomplete="off"
          aria-label="Search term"
          id="search-input">
        <span id="search-cancel"></span>
      </div>
      <ul class="üçú üí™ ü¶∑ ‚öñÔ∏è top-nav" id="top-nav" >
        {{if .IsLoggedIn}}
        <span class="top-link" id="search-start" tabindex=0></span>
        <form method="post" action="/logout" id="top-link">
          <input type="hidden" name="name" value="value" />
          <a onclick="this.parentNode.submit();">Logout</a>
        </form>
        <a href="/account">Account</a>
        {{else}}
        <a href="/demo">Demo</a>
        {{end}}
      </ul>
    </div>
  </header>
  <div class="üí™ üå≥ ‚öñÔ∏è">
    {{template "main" .}}
  </div>
  <footer class="üí™ ü™ú">
    <div class="üìû" style="margin-bottom: 12px">
      <a href="{{.EapUrl}}">Join our Early Access Program!</a>
    </div>
    <ul class="üî´ üçú üö´ footer-links">
      <li><a href="about.txt">About</a></li>
      <li><a href="api.txt">API</a></li>
      <li><a href="security.txt">Security</a></li>
      <li><a href="legal.txt">Legal</a></li>
      <li><a href="mailto:{{.ContactEmail}}">Contact</a></li>
    </ul>
  </footer>
<script>

let $ = l => document.getElementById(l);
let rm = (l, c) => $(l).classList.remove(c);
let ad = (l, c) => $(l).classList.add(c);
let searchBoxInFocus = false,
                   c = 'click',
                   u = 'keyup',
                   z = 'addEventListener',
                   p = 'preventDefault';
    
function fo(q) {
  searchBoxInFocus = true;
  rm('search-box', 'üëª');
  ad('top-nav', 'üëª');
  ad('main', 'üåÉ');
  ad('logo', 'üåÉ');
  if(q && q.length > 0) $('search-input').value = q;
  $('search-input').focus();
}

function defo() {
  searchBoxInFocus = false;
  ad('search-box', 'üëª');
  rm('top-nav', 'üëª');
  rm('main', 'üåÉ');
  rm('logo', 'üåÉ');
  $('search-input').value = '';
}

const ss = $('search-start');
if(ss)  {
  ss[z](c, fo);
  ss[z](u, e => e.code == 'Enter' && e[p]() && fo());
}

    document[z]('keydown', e => {
      if (!searchBoxInFocus && e.code == 'Backslash') e[p](), fo(e);
    });
    $('search-input')[z]('keydown', e => {
      if(!searchBoxInFocus) return;
      if (e.code == 'Escape') e[p](), defo();
      else if (e.code == 'Enter') {
        {{if not .IsLoggedIn}}
          window.location.href = '/login?error=4';
        {{else}}
          e[p]();
          s($('search-input').value);
        {{end}}
      } else if (e.code == 'Tab') e[p]();
    });
    $('search-cancel')[z](c, defo);
    
    const elNavGcp = $("nav-gcp");
    if (elNavGcp) {
      if (localStorage.getItem('nav-gcp-open') == 'true') elNavGcp.open = true;

      elNavGcp[z]("toggle", _ => {
        localStorage.setItem('nav-gcp-open', elNavGcp.open);
      });
    } 

console.log("%c Hello Y = f=>(x=>x(x))(x=>f(y=>x(x)(y)))", "font-size: 24px;background: #67b26f; background: -webkit-linear-gradient(to right, #67b26f, #4ca2cd); background: linear-gradient(to right, #67b26f, #4ca2cd); color: white;text-align: center; padding: 10px 15px; width: 100%;border-radius: 20px;");   

{{if .IsSearch}}
let             q = '';
              sqb = false,
        baseQuery = (q.length > 0 && q.split(':::')[0] ) || '',
                f = ['all', 'substring', 'lastmonth'],
                r = $("query"),
 elSearchAdvanced = $("search-advanced"),
            elSoq = $('search-original-query'),
          elSbrId = 'search-builder-reset',
            elSbr = $(elSbrId),
        elSrctaId = 'search-redo-cta',
            srcta = $(elSrctaId),
           elQbId = 'query-builder',
            elHId = 'search-header', 
               dd = 'down';
 {{if .Query}}  q = '{{.Query}}' {{end}};
                o = q || '';


elSearchAdvanced[z](c, _ => {
  if(sqb) elSearchAdvanced.classList.add(dd), ad(elQbId, "ü•∑");
  else elSearchAdvanced.classList.remove(dd), rm(elQbId, "ü•∑");
  sqb = !sqb;
}); 
elSearchAdvanced[z](u, (e) => {
  if(e.code == 'Enter') { event[p]();
    if(sqb)
      elSearchAdvanced.classList.add(dd),
      sqb = false,
      ad(elQbId, "ü•∑");
    else
      elSearchAdvanced.classList.remove(dd),
      sqb = true,
      rm(elQbId, "ü•∑");
  }
});

elSbr[z](c, _ => { r.value = o, resetSearchState() });
    
function resetSearchState() {
  rm(elHId, '‚ö°');
  ad(elSrctaId, '‚ö°');
  ad(elSbrId, 'ü•∑');
  elSoq.innerText = '';
}
function updateQuery(tk = []) {
  if(f[0] != "all") tk.push("provider:" + f[0]);
  if(f[1] != "substring") tk.push("algo:" + f[1]);
  if(f[2] != "lastmonth") tk.push("time:" + f[2]);
  if(tk.length == 0) {
    r.value = r.value.split(":::")[0].trim()
    if(r.value == o) resetSearchState();
  } else {
    q = [r.value.split(":::")[0].trim(), ":::", ...tk].join(" ").trim();
    if (q == o) {
      r.value = o;
      resetSearchState();
    } else {
      r.value = q;
      ad(elHId, '‚ö°');
      elSoq.innerText = o;
      rm(elSrctaId, '‚ö°');
      rm(elSbrId, 'ü•∑');
    }
  }
}
function change(e, i) { f[i] = e.target.value, updateQuery() }
r[z](u, e => {
  e[p]();
  if(e.code == 'Enter') s(e.target.value);
  else if(e.target.value == o) q = e.target.value, resetSearchState();
  else {
    q = e.target.value;
    ad(elHId, '‚ö°');
    elSoq.innerText = o;
    rm(elSrctaId, '‚ö°');
    rm(elSbrId, 'ü•∑');
  }
});
srcta[z](c, e => q != o && e[p]() && s(q));  
srcta[z](u, e => event.code == 'Enter' && q != o && e[p]() && s(q));
{{end}}

const lnl = document.querySelectorAll('.left-nav-link');
lnl && lnl.forEach(el => {
  if (el.querySelector('a').href.split('?')[0] == window.location.href.split('?')[0]) {
    el.classList.add('active');
    return;
  }
});
function s(q) { window.location.href = '/search?q=' + encodeURI(q); }
</script>